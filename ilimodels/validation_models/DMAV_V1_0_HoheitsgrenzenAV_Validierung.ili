INTERLIS 2.4;

MODEL DMAV_V1_0_HoheitsgrenzenAV_Validierung (de) 
AT "https://www.kgk-cgc.ch/" 
VERSION "2025-03-30" =
  
IMPORTS UNQUALIFIED INTERLIS;
IMPORTS UNQUALIFIED Text_V2;
IMPORTS UNQUALIFIED Math_V2_1;
IMPORTS UNQUALIFIED ObjectPool_V1_0;
IMPORTS UNQUALIFIED Elements_V1_0;
IMPORTS DMAVTYM_Topologie_V1_0;
IMPORTS DMAV_FixpunkteAVKategorie3_V1_0;
IMPORTS DMAV_Bodenbedeckung_V1_0;
IMPORTS DMAV_Einzelobjekte_V1_0;
IMPORTS DMAV_Nomenklatur_V1_0;
IMPORTS DMAV_Grundstuecke_V1_0;
IMPORTS DMAV_Rohrleitungen_V1_0;
IMPORTS DMAV_HoheitsgrenzenAV_V1_0;
IMPORTS DMAV_Toleranzstufen_V1_0;
IMPORTS DMAV_Gebaeudeadressen_V1_0;
IMPORTS KGKCGC_FPDS2_V1_1;
IMPORTS FixpunkteLV_V1_0;
IMPORTS Gemeinden95_V1_0;

    VIEW TOPIC HoheitsgrenzenAV_Validierung = 
    DEPENDS ON DMAV_HoheitsgrenzenAV_V1_0.HoheitsgrenzenAV;

        VIEW v_Gemeinde
            PROJECTION OF DMAV_HoheitsgrenzenAV_V1_0.HoheitsgrenzenAV.Gemeinde;
        =
            ALL OF Gemeinde;

            !!@ ilivalid.msg="Unbekannte oder falsche Gemeinde";
            !!@ ilivalid.msg_de="Unbekannte oder falsche Gemeinde";
            !!@ ilivalid.msg_fr="Commune inconnue ou fausse";
            !!@ ilivalid.msg_it="Il comune è sconosciuto o errato";
            !! Kategorie: modellübergreifend zu neuem Modell
            !! Umsetzung Phase 2;
            !! Failcase für Testsuite erstellt (Testsuite_DMAV/DMAV_V1_0_Validierung/DMAV_V1_0_Validierung.HoheitsgrenzenAV_Validierung.v_Gemeinde.CH112352)
/*             MANDATORY CONSTRAINT CH112352: (
                INTERLIS.objectCount(ObjectPool_V1_0.filter(ObjectPool_V1_0.allObjects(>Gemeinden95_V1_0.Gemeinden.Gemeinde), "BFSNr == {BFSNummer} AND Name == {Name}")) == 1
            ); */   

        END v_Gemeinde;

        VIEW v_Gemeindegrenze
            PROJECTION OF DMAV_HoheitsgrenzenAV_V1_0.HoheitsgrenzenAV.Gemeindegrenze;
        =
            ALL OF Gemeindegrenze;

            !!@ ilivalid.check = warning
            !!@ ilivalid.msg="Flächenperimeter muss mit Referenzperimeter der Liegenschaften übereinstimmen (Toleranz 2 mm)";
            !!@ ilivalid.msg_de="Flächenperimeter muss mit Referenzperimeter der Liegenschaften übereinstimmen (Toleranz 2 mm)";
            !!@ ilivalid.msg_fr="Le périmètre doit être identique au périmètre de référence des biens-fonds (tolérance 2 mm)";
            !!@ ilivalid.msg_it="Il perimetro deve coincidere con il perimetro di riferimento del bene immobile (Tolleranza 2 mm)";
            !! AGI SH: Failcase umgesetzt;
            !! Kategorie: modellübergreifend
            !! Umsetzung Phase 2;
            SET CONSTRAINT CH113051: WHERE DEFINED(Entstehung) AND NOT(DEFINED(Untergang)): (
                    DMAVTYM_Topologie_V1_0.isGeometrySpatiallyEqual(ALL, >>Geometrie, ObjectPool_V1_0.filter(ObjectPool_V1_0.allObjects(>DMAV_Grundstuecke_V1_0.Grundstuecke.Liegenschaft), "DEFINED(Grundstueck->Entstehung) AND NOT(DEFINED(Grundstueck->Untergang))"), >>DMAV_Grundstuecke_V1_0.Grundstuecke.Liegenschaft->Geometrie, 0.002)
            );
        
        END v_Gemeindegrenze;

        VIEW v_Bezirksgrenzabschnitt
            PROJECTION OF DMAV_HoheitsgrenzenAV_V1_0.HoheitsgrenzenAV.Bezirksgrenzabschnitt;
        =
            ALL OF Bezirksgrenzabschnitt;

            !!@ ilivalid.msg="Grenzverlauf der Bezirksgrenze muss identisch mit Gemeindegrenze sein";
            !!@ ilivalid.msg_de="Grenzverlauf der Bezirksgrenze muss identisch mit Gemeindegrenze sein";
            !!@ ilivalid.msg_fr="Le tracé de la limite de district doit être identique au tracé de la limite communale";
            !!@ ilivalid.msg_it="L'andamento dei confini distrettuali deve corrispondere con quelli comunali";
            !! Umsetzung Phase 1;
            !! Failcase für Testsuite erstellt (Testsuite_DMAV/DMAV_V1_0_Validierung/DMAV_V1_0_Validierung.HoheitsgrenzenAV_Validierung.v_Bezirksgrenzabschnitt.CH120153)
            MANDATORY CONSTRAINT CH120153: (
                DMAVTYM_Topologie_V1_0.coversWithTolerance(ObjectPool_V1_0.allObjects(>DMAV_HoheitsgrenzenAV_V1_0.HoheitsgrenzenAV.Gemeindegrenze), >>DMAV_HoheitsgrenzenAV_V1_0.HoheitsgrenzenAV.Gemeindegrenze->Geometrie, THIS, >>Geometrie, 0.002)
            );

        END v_Bezirksgrenzabschnitt;

        VIEW v_Kantonsgrenzabschnitt
            PROJECTION OF DMAV_HoheitsgrenzenAV_V1_0.HoheitsgrenzenAV.Kantonsgrenzabschnitt;
        =
            ALL OF Kantonsgrenzabschnitt;

            !!@ ilivalid.msg="Grenzverlauf der Kantonsgrenze muss identisch mit Bezirksgrenze sein";
            !!@ ilivalid.msg_de="Grenzverlauf der Kantonsgrenze muss identisch mit Bezirksgrenze sein";
            !!@ ilivalid.msg_fr="Le tracé de la limite du canton doit être identique au tracé de la limite de district";
            !!@ ilivalid.msg_it="L'andamento del confine cantonale deve corrispondere con quelli comunali";
            !! AGI SH: Failcase umgesetzt;
            !! Umsetzung Phase 1;
            MANDATORY CONSTRAINT CH130153: (
                DMAVTYM_Topologie_V1_0.coversWithTolerance(ObjectPool_V1_0.allObjects(>DMAV_HoheitsgrenzenAV_V1_0.HoheitsgrenzenAV.Bezirksgrenzabschnitt), >>DMAV_HoheitsgrenzenAV_V1_0.HoheitsgrenzenAV.Bezirksgrenzabschnitt->Geometrie, THIS, >>Geometrie, 0.002)
            );

        END v_Kantonsgrenzabschnitt;

    END HoheitsgrenzenAV_Validierung;

END DMAV_V1_0_HoheitsgrenzenAV_Validierung.
